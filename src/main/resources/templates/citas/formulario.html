<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${cita.id != null} ? 'Editar Cita' : 'Nueva Cita'">Formulario Cita - Veterinaria Copelo</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>
    <div class="container">
        <header class="hero">
            <h1 th:text="${cita.id != null} ? '‚úèÔ∏è Editar Cita' : 'üìÖ Nueva Cita'">Formulario Cita</h1>
            <p th:text="${cita.id != null} ? 'Modifica los datos de la cita' : 'Programa una nueva cita veterinaria'">Formulario de cita</p>
        </header>
        
        <nav class="breadcrumb">
            <a href="/">Inicio</a> > 
            <a href="/citas">Citas</a> > 
            <span th:text="${cita.id != null} ? 'Editar' : 'Nueva'">Formulario</span>
        </nav>
        
        <main>
            <!-- Mostrar mensajes de error -->
            <div th:if="${param.error}" class="alert alert-error">
                Error: <span th:text="${param.error}"></span>
            </div>
            
            <div class="card">
                <form th:action="@{/citas/guardar}" th:object="${cita}" method="post">
                    <input type="hidden" th:field="*{id}">
                    
                    <div class="form-group">
                        <label for="fechaHora">Fecha y Hora:</label>
                        <input type="datetime-local" id="fechaHora" th:field="*{fechaHora}" required 
                               class="form-control" th:value="${{cita.fechaHora != null} ? 
                               #temporals.format(cita.fechaHora, 'yyyy-MM-dd\\'T\\'HH:mm') : ''}">
                        <small>Formato: AAAA-MM-DD HH:MM</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="mascota">Mascota:</label>
                        <select id="mascota" name="mascotaId" required class="form-control">
                            <option value="">Selecciona una mascota</option>
                            <option th:each="mascota : ${mascotas}" 
                                    th:value="${mascota.id}" 
                                    th:text="${mascota.nombre + ' (' + mascota.especie + ') - Due√±o: ' + mascota.dueno.nombreCompleto}"
                                    th:selected="${cita.mascota != null and cita.mascota.id == mascota.id}">
                            </option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="tipo">Tipo de Cita:</label>
                        <select id="tipo" th:field="*{tipo}" required class="form-control">
                            <option value="">Selecciona el tipo</option>
                            <option value="CONSULTA">Consulta General</option>
                            <option value="VACUNACI√ìN">Vacunaci√≥n</option>
                            <option value="CIRUG√çA">Cirug√≠a</option>
                            <option value="URGENCIA">Urgencia</option>
                            <option value="EST√âTICA">Est√©tica (Ba√±o/Corte)</option>
                            <option value="DESPARASITACI√ìN">Desparasitaci√≥n</option>
                            <option value="CONTROL">Control</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="motivo">Motivo de la Cita:</label>
                        <textarea id="motivo" th:field="*{motivo}" class="form-control" rows="3" 
                                  placeholder="Describe el motivo de la cita..." required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="estado">Estado:</label>
                        <select id="estado" th:field="*{estado}" required class="form-control">
                            <option value="">Selecciona el estado</option>
                            <option value="PROGRAMADA">Programada</option>
                            <option value="COMPLETADA">Completada</option>
                            <option value="CANCELADA">Cancelada</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="diagnostico">Diagn√≥stico:</label>
                        <textarea id="diagnostico" th:field="*{diagnostico}" class="form-control" rows="3" 
                                  placeholder="Diagn√≥stico m√©dico (completar despu√©s de la cita)..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="tratamiento">Tratamiento:</label>
                        <textarea id="tratamiento" th:field="*{tratamiento}" class="form-control" rows="3" 
                                  placeholder="Tratamiento indicado..."></textarea>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">üíæ Guardar Cita</button>
                        <a th:href="@{/citas}" class="btn btn-secondary">‚ùå Cancelar</a>
                    </div>
                </form>
            </div>
        </main>
        
        <footer>
            <p>&copy; 2025 Veterinaria Copelo</p>
        </footer>
    </div>
</body>
</html>